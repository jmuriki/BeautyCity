<!DOCTYPE html>
{% extends 'base.html' %}
{% load static %}

{% block links %}

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<!-- 	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css.map">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css.map"> -->
	<link rel="stylesheet" href="{% static 'css/bootstrap-grid.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/air-datepicker.css' %}">
	<script src="{% static 'js/air-datepicker.js' %}"></script>
	<link rel="stylesheet" href="{% static 'css/main.css' %}">

{% endblock %}

{% block body %}

<body class="servicePage">

{% endblock %}

{% block content %}

	<section id="service">
		<div class="container">
			<div class="service">
				<div class="breadCrumbs">
					<a href="{% url 'main_page' %}" class="breadCrumbs__item">На главную</a>
				</div>
				<div class="service__block">
					<h1 class="service__title">Запись на услугу</h1>
					<button class="service__btn btn">Запись по телефону</button>
				</div>
				
				<form action="{% url 'serviceFinally' %}" class="service__form">

					{% csrf_token %}

					<div class="service__form_block service__salons">
						<button class="accordion">(Выберите салон)</button>
						<div class="panel">

							{% if salons %}

								{% for salon in salons %}

									<div class="accordion__block fic">
										<div class="accordion__block_intro">{{ salon.name }}</div>
										<div class="accordion__block_address">{{ salon.address }}</div>
									</div>

								{% endfor %}

							{% endif %}

						</div>
					</div>
					<div class="service__form_block service__services">
						<button class="accordion">(Выберите услугу)</button>
						<div class="panel">

							{% if categories %}

								{% for category in categories %}

									<button class="accordion">{{ category }}</button>
									<div class="panel">

										{% for service in category.services.all %}

											<div class="accordion__block_items">
												<div class="accordion__block_item fic">
													<div class="accordion__block_item_intro">{{ service.name }}</div>
													<div class="accordion__block_item_address">{{ service.price }} ₽</div>
												</div>
											</div>

										{% endfor %}

									</div>

								{% endfor %}

							{% endif %}

						</div>
					</div>
					<div class="service__form_block service__masters">
						<button class="accordion">(Выберите мастера)</button>
						<div class="panel">

							{% if masters %}

								{% for master in masters %}

									<div class="accordion__block fic">
										<div class="accordion__block_elems fic">
											{% if master.foto %}
												<img src="{% static master.foto.url %}" alt="avatar" class="accordion__block_img">
											{% endif %}
											<div class="accordion__block_master">{{ master.name }}</div>
										</div>
										<div class="accordion__block_prof">{{ master.specialization }}</div>
									</div>

								{% endfor %}

							{% endif %}

						</div>
							
						

					</div>
					
				</form>
			</div>
		</div>
	</section>

	<section id="time">
		<div class="container">
			<div class="time">
				<h2 class="time__title">Выберите время</h2>
				<div class="time__block">
					<div class="row">
						<div class="col-md-4">
							<div id="datepickerHere"></div>
						</div>
						<div class="col-md-8">
							<div class="time__elems">
								<div class="time__items">
									<div class="time__elems_intro">Утро</div>
									<div class="time__elems_elem fic">
										<button data-time="10:00" class="time__elems_btn" name="selected_time">10:00</button>
										<button data-time="10:30" class="time__elems_btn" name="selected_time">10:30</button>
									</div>
								</div>
								<div class="time__items">
									<div class="time__elems_intro">День</div>
									<div class="time__elems_elem fic">
										<button data-time="12:00" class="time__elems_btn" name="selected_time">12:00</button>
										<button data-time="12:30" class="time__elems_btn" name="selected_time">12:30</button>
										<button data-time="15:00" class="time__elems_btn" name="selected_time">15:00</button>
										<button data-time="16:30" class="time__elems_btn" name="selected_time">16:30</button>
									</div>
								</div>
								<div class="time__items">
									<div class="time__elems_intro">Вечер</div>
									<div class="time__elems_elem fic">
										<button data-time="17:00" class="time__elems_btn" name="selected_time">17:00</button>
										<button data-time="18:30" class="time__elems_btn" name="selected_time">18:30</button>
										<button data-time="19:00" class="time__elems_btn" name="selected_time">19:00</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="time__btns">
					<div class="row">
						<div class="col-md-12">
							<button id="Далее" class="time__btns_next">Далее</button>
							<button  class="time__btns_home">На главную</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<script>

		$(document).ready(function() {

			$('.time__items .time__elems_elem .time__elems_btn').click(function(e) {
				e.preventDefault()
				$('.time__elems_btn').removeClass('active')
				$(this).addClass('active')
				// $(this).hasClass('active') ? $(this).removeClass('active') : $(this).addClass('active')
			});

			$(document).on('click', '.servicePage', function() {
				if($('.time__items .time__elems_elem .time__elems_btn').hasClass('active') && $('.service__form_block > button').hasClass('selected')) {
					$('.time__btns_next').addClass('active')
				}
			});

			$('.time__btns_next').click(function(e) {
				e.preventDefault(); // Предотвращаем стандартное поведение кнопки
				var form = $('.service__form'); // Получаем форму
				var formData = form.serialize(); // Собираем данные из формы
				var url = form.attr('action'); // Получаем URL-адрес из атрибута action формы

				// Отправляем POST запрос
				$.post(url, formData, function(response) {
					// Обрабатываем ответ сервера
					console.log(response);
				});
			});

		})

	</script>

{% endblock %}
